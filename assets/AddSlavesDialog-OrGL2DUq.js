import{_ as pe}from"./DialogCloseBtn-dlJmgPOI.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as H,b as xe}from"./VCard-C_R7hSZu.js";import{V as ae}from"./VCardTitle-D4KXAsEB.js";import{V as K}from"./VDivider-BRZJMS0Y.js";import{V as ke}from"./VSlideGroup-m9bzUaex.js";import{V as Se}from"./VSlideGroupItem-BW08wQaw.js";import{V as he}from"./VSkeletonLoader-CJ48hQXm.js";import{V as te}from"./VCardText-DxS0I0_1.js";import{r as t,o as n,c as I,b as l,e as a,d as r,t as b,F as ne,h as me,f as V,H as De,x as we,v as C,ah as M,w as Z,b0 as Ue,y as w,m as X,$ as Ce,b9 as Me,ba as Le}from"./index-JiK_MWJ9.js";import{V as J}from"./VDialog-BldaqJjN.js";import{r as G}from"./validators-DpYrMFzk.js";import{_ as Be}from"./AppTextField-DwceRF1z.js";import{_ as ve}from"./AppSelect-CfgfDHHL.js";import{_ as $e}from"./AppTextarea-CT_9uWRx.js";import{$ as ee}from"./api-wE93wIMu.js";import{V as Ee}from"./VForm-CE-k84KN.js";import{V as U,a as d}from"./VRow-DcfChc3a.js";import{V as Ae}from"./VCheckbox-Cyr_f3W9.js";import{V as le}from"./VSwitch-DfqrArvL.js";import{V as ce}from"./VChip-LXx84AeF.js";import{V as qe}from"./VSpacer-FUnwweiR.js";const Te={class:"sticky-card"},ze={key:0,class:"pa-3 pa-sm-4"},Ie=["onClick"],Fe={class:"text-base font-weight-medium mx-2"},Oe={__name:"changeServerSlaveDialog",props:{isDialogVisible:{type:Boolean,required:!0},serverDetails:{type:Object,required:!1}},emits:["submit","update:isDialogVisible"],setup(g,{emit:W}){const p=t(0),S=g,h=W,m=L=>{h("update:isDialogVisible",L)};function y(){h("serverChanged",S.serverDetails[p.value].id),m()}return(L,v)=>{const D=pe;return n(),I("section",null,[l(J,{width:L.$vuetify.display.smAndDown?"auto":650,"model-value":S.isDialogVisible,"onUpdate:modelValue":m},{default:a(()=>[l(D,{onClick:v[0]||(v[0]=f=>m(!1))}),l(H,null,{default:a(()=>[r("div",Te,[l(ae,{class:"pt-3"},{default:a(()=>[b("Change Server ")]),_:1}),l(K)]),l(xe,{class:"pt-5 pb-5"},{default:a(()=>[b("Select Server")]),_:1}),g.serverDetails?(n(),I("div",ze,[l(ke,{modelValue:p.value,"onUpdate:modelValue":v[1]||(v[1]=f=>p.value=f),"show-arrows":""},{default:a(()=>[(n(!0),I(ne,null,me(g.serverDetails,(f,i)=>(n(),V(Se,{key:f.id,value:i},{default:a(({isSelected:x,toggle:B})=>[r("div",{style:De([{"block-size":"30px","inline-size":"100px"},x?"border-color: rgb(var(--v-theme-primary)) !important":""]),class:we([x?"border":"border border-dashed","d-flex flex-column justify-center align-center cursor-pointer rounded py-6 px-5 me-4"]),onClick:B},[r("h6",Fe,C(f.server_name),1)],14,Ie)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])):(n(),I(ne,{key:1},me(3,f=>l(he,{key:f,type:"list-item-two-line"})),64)),l(te,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[l(M,{variant:"tonal",color:"secondary",onClick:v[2]||(v[2]=f=>m(!1))},{default:a(()=>[b(" Close ")]),_:1}),l(M,{color:"primary",onClick:v[3]||(v[3]=f=>y())},{default:a(()=>[b(" Change Server ")]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"])])}}},hl=fe(Oe,[["__scopeId","data-v-30f9ac3c"]]),Q=g=>(Me("data-v-1f931cd8"),g=g(),Le(),g),je={class:"sticky-card"},Ne=Q(()=>r("label",{class:"v-label text-body-2 text-high-emphasis",for:"firstName"},"Select Master Account",-1)),Pe=Q(()=>r("label",{class:"v-label text-body-2 text-high-emphasis",for:"firstName"},"Enter Slave MT5 Id",-1)),Re={class:"mt-1"},Xe={class:"mt-1"},Ge={class:"mt-1"},He={class:"d-flex align-center gap-1 flex-wrap"},Ke=Q(()=>r("span",{class:"text-body-2"},"ðŸ‘ SLAVE IDS VALIDATED",-1)),Je={class:"text-body-2"},Qe={key:2},We={class:"text-overline"},Ye={class:"text-h4 mb-4"},Ze=Q(()=>r("span",{class:"text-5xl font-weight-light"},"X",-1)),el={class:"text-h4 mb-4"},ll={__name:"AddSlavesDialog",props:{isDialogVisible:{type:Boolean,required:!0},masterDropDown:{type:Object,required:!0}},emits:["submit","update:isDialogVisible"],setup(g,{emit:W}){t(!1),t([]),t(""),t([]);const p=t(null);t(!1);const S=t(!1),h=t(!1),m=t(""),y=t(""),L=t(""),v=t(""),D=t(!1),f=[{text:"Fixed Lot",value:"FIXL"},{text:"Lot Multiplier",value:"LMUL"},{text:"Balance Multiplier",value:"BMUL"},{text:"Equity Multiplier",value:"EMUL"},{text:"Fixed Balance Multiplier",value:"FBMUL"}],i=t(null),x=t(100),B=t(0);t(!1),t(!1);const $=t(!1),E=t(0),A=t(30);t(!1);const q=t(!1),T=t(!1);t(!1),t(null);const se=t(!0);t(!1);const P=g,F=W,O=t(!1),k=t(null),_e=t({}),oe=t([]),c=t(""),ue=[o=>/^\d+(,\d+)*$/.test(o)||"Only comma-separated numbers allowed",o=>{const e=o.split(",").map(_=>_.trim()),s=new Set(e);return e.length===s.size||"Duplicate values are not allowed"}],Y=o=>/^(\d+|\d*\.\d{1,2})$/.test(o.toString())||"Must be a number with up to 2 decimal places";Z([i,p,k,c],()=>{i.value&&p.value?se.value=!1:i.value&&c.value&&ue.every(e=>e(c.value)===!0)&&(de.value=!1)},{deep:!0,immediate:!1}),Z(()=>P.masterDropDown,o=>{o&&(oe.value=P.masterDropDown)});const re=o=>{F("update:isDialogVisible",o)},Ve=o=>{k.value=o,_e.value=P.masterList.value.find(e=>e.id===k.value)},ie=()=>{F("reload"),h.value=!1,S.value=!1,F("update:isDialogVisible",!1)},be=async()=>{D.value=!0;const o={master_id:k.value,sl_mt5_id:p.value,server_id:1,mapped_by:1,is_config_unique:1,risk_approach:i.value,lot_size:E.value,multiplier:x.value,fixed_balance:B.value,copy_sl:q.value,copy_tp:T.value,is_reverse:$.value,status:!0,is_live:!0,commission_percentage:A.value};try{const e=await ee("slaves/store",{method:"POST",body:o,onResponseError({response:s}){if(s&&s._data&&s._data.message)m.value="Error!",y.value=s._data.message;else if(s&&s._data&&s._data.errors){const _=Object.values(s._data.errors).flat().join(", ");m.value="Validation Error!",y.value=_||"There was a validation error."}else m.value="Error!",y.value="Something went wrong.";D.value=!1,S.value=!0}});e&&(L.value="Success!",v.value="Slave account added successfully!",D.value=!1,h.value=!0,p.value=null,i.value=null,k.value=null,E.value=100,x.value=null,q.value=!1,T.value=!1,$.value=!1,A.value=30,F("submit",e))}catch(e){console.error("Unexpected Error:",e),console.log("Unexpected Error:",e)}},z=t(!1),j=t(""),de=t(!0),N=t(!1),R=t(0),ge=o=>{o.preventDefault();let e=(o.clipboardData||window.clipboardData).getData("text");e=e.split(`
`).map(s=>s.trim()).filter(s=>s!=="").join(","),c.value=c.value?`${c.value},${e}`.replace(/,+/g,","):e};Z(c,o=>{if(!o){R.value=0;return}j.value="";const e=[...new Set(o.split(",").map(s=>s.trim()).filter(s=>/^\d+$/.test(s)))];c.value=o.split(/[\n,]/).map(s=>s.trim()).filter(s=>/^\d+$/.test(s)).join(","),R.value=e.length});const ye=async()=>{if(z.value){N.value=!0;const o={master_id:k.value,sl_mt5_ids:c.value,server_id:1,mapped_by:1,is_config_unique:1,risk_approach:i.value,lot_size:E.value,multiplier:x.value,fixed_balance:B.value,copy_sl:q.value,copy_tp:T.value,is_reverse:$.value,status:!0,is_live:!0,commission_percentage:A.value};try{const e=await ee("slaves/bulk-store",{method:"POST",body:o,onResponseError({response:s}){if(s&&s._data&&s._data.message)m.value="Error!",y.value=s._data.message;else if(s&&s._data&&s._data.errors){const _=Object.values(s._data.errors).flat().join(", ");m.value="Validation Error!",y.value=_||"There was a validation error."}else m.value="Error!",y.value="Something went wrong.";D.value=!1,S.value=!0}});e&&(L.value="Success!",v.value=e.message,D.value=!1,h.value=!0,p.value=null,i.value=null,k.value=null,E.value=100,x.value=null,q.value=!1,T.value=!1,$.value=!1,A.value=30,F("submit",e))}catch(e){console.error("Unexpected Error:",e),console.log("Unexpected Error:",e)}}else{N.value=!0;const o={mt5_ids:c.value};try{const e=await ee("validate-bulk-slave-ids",{method:"POST",body:o,onResponseError({response:s}){console.log(s),console.log(s._data.message),j.value=s._data.message+"  : "+s._data.existing_ids.toString(),z.value=!1,N.value=!1}});e&&(console.log(e),console.log(e.message),j.value=e.message,z.value=!0,N.value=!1)}catch(e){console.error("Unexpected Error:",e),console.log("Unexpected Error:",e)}}};return(o,e)=>{const s=pe,_=Be;return n(),I("section",null,[l(J,{width:o.$vuetify.display.smAndDown?"auto":650,"model-value":P.isDialogVisible,"onUpdate:modelValue":re},{default:a(()=>[l(s,{onClick:e[0]||(e[0]=u=>re(!1))}),l(H,null,{default:a(()=>[r("div",je,[l(ae,{class:"pt-3"},{default:a(()=>[b("Add Slave Account")]),_:1}),l(K)]),l(Ee,{onSubmit:Ue(()=>{},["prevent"])},{default:a(()=>[l(K,{class:"mb-2"}),l(U,{class:"ml-3 mr-3 mt-3"},{default:a(()=>[l(d,{cols:"12",md:"6",class:"d-flex align-items-center"},{default:a(()=>[Ne]),_:1}),l(d,{cols:"12",md:"6"},{default:a(()=>[l(ve,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=u=>k.value=u),items:oe.value,placeholder:"Select Master","item-title":"text","item-value":"value",outlined:"",dense:"",clearable:"","clear-icon":"tabler-x",class:"invoice-list-filter",onChange:Ve},null,8,["modelValue","items"])]),_:1})]),_:1}),l(U,{class:"ml-1 mr-1"},{default:a(()=>[l(d,{cols:"6"},{default:a(()=>[l(Ae,{modelValue:O.value,"onUpdate:modelValue":e[2]||(e[2]=u=>O.value=u),label:"Add Multiple Slaves",class:"pb-3"},null,8,["modelValue"])]),_:1}),l(d,{cols:"6"})]),_:1}),l(K),O.value?w("",!0):(n(),V(U,{key:0,class:"ml-3 mr-3 mt-3"},{default:a(()=>[l(d,{cols:"12",md:"6",class:"d-flex align-items-center"},{default:a(()=>[Pe]),_:1}),l(d,{cols:"12",md:"6"},{default:a(()=>[l(_,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=u=>p.value=u),suffix:"MT5"},null,8,["modelValue"])]),_:1})]),_:1})),l(U,{class:"ml-3 mr-3 mt-2"},{default:a(()=>[l(d,{cols:"6"},{default:a(()=>[l(_,{label:"Commission",modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=u=>A.value=u),type:"number",min:"0",suffix:"%"},null,8,["modelValue"])]),_:1}),l(d,{cols:"6"},{default:a(()=>[l(ve,{modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=u=>i.value=u),items:f,"item-title":"text","item-value":"value",label:"Risk Approach","single-line":"",rules:["requiredValidator"in o?o.requiredValidator:X(G)]},null,8,["modelValue","rules"])]),_:1}),i.value==="FIXL"?(n(),V(d,{key:0,cols:"6",class:""},{default:a(()=>[l(_,{label:"Lot Size",modelValue:E.value,"onUpdate:modelValue":e[6]||(e[6]=u=>E.value=u),type:"number",min:"0",rules:["requiredValidator"in o?o.requiredValidator:X(G),Y]},null,8,["modelValue","rules"])]),_:1})):w("",!0),i.value==="LMUL"||i.value==="BMUL"||i.value==="EMUL"||i.value==="FBMUL"?(n(),V(d,{key:1,cols:"6",class:""},{default:a(()=>[l(_,{label:"Multiplier",modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=u=>x.value=u),type:"number",min:"0",suffix:"%",rules:["requiredValidator"in o?o.requiredValidator:X(G),Y]},null,8,["modelValue","rules"])]),_:1})):w("",!0),i.value==="FBMUL"?(n(),V(d,{key:2,cols:"6"},{default:a(()=>[l(_,{label:"Fixed Master Balance",modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]=u=>B.value=u),type:"number",min:"0",rules:["requiredValidator"in o?o.requiredValidator:X(G),Y]},null,8,["modelValue","rules"])]),_:1})):w("",!0)]),_:1}),l(U,{class:"ml-3 mr-3 mt-2"},{default:a(()=>[l(ae,{class:"mt-2"},{default:a(()=>[b("Advanced Settings")]),_:1}),l(U,{class:"ml-2"},{default:a(()=>[l(d,{cols:"4"},{default:a(()=>[r("div",Re,[l(le,{modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=u=>q.value=u),label:"Copy Stop Loss"},null,8,["modelValue"])])]),_:1}),l(d,{cols:"4"},{default:a(()=>[r("div",Xe,[l(le,{modelValue:T.value,"onUpdate:modelValue":e[10]||(e[10]=u=>T.value=u),label:"Copy Take Profit"},null,8,["modelValue"])])]),_:1}),l(d,{cols:"4"},{default:a(()=>[r("div",Ge,[l(le,{modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=u=>$.value=u),label:"Reverse Trade"},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1}),O.value?(n(),V(U,{key:1,class:"ml-3 mr-3 mt-3"},{default:a(()=>[l(d,{cols:"12",md:"12"},{default:a(()=>[l($e,{modelValue:c.value,"onUpdate:modelValue":e[12]||(e[12]=u=>c.value=u),label:"Add Slaves",rules:ue,rows:"5",placeholder:"Enter unique numbers separated by commas (e.g. 1001,1002,1003)",onPaste:ge},null,8,["modelValue"]),r("div",He,[z.value?(n(),V(ce,{key:0,color:"success",class:"mt-2"},{default:a(()=>[Ke]),_:1})):w("",!0),!z.value&&j.value.length>0?(n(),V(ce,{key:1,color:"error",class:"mt-2"},{default:a(()=>[r("span",Je,"ðŸ‘Ž "+C(j.value),1)]),_:1})):w("",!0),l(qe),R.value>0?(n(),I("div",Qe,[r("span",We,"COUNT: "+C(R.value),1)])):w("",!0)])]),_:1})]),_:1})):w("",!0),l(U,{class:"ml-3 mt-2 mb-2"},{default:a(()=>[l(d,{cols:"6"},{default:a(()=>[O.value?(n(),V(M,{key:0,class:"me-2",color:"primary",onClick:ye,loading:N.value,disabled:de.value},{default:a(()=>[b(C(z.value?"Add Slaves":"Validate Slaves"),1)]),_:1},8,["loading","disabled"])):(n(),V(M,{key:1,class:"me-2",color:"primary",onClick:be,loading:D.value,disabled:se.value},{default:a(()=>[b(" Add Slave ")]),_:1},8,["loading","disabled"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),l(J,{modelValue:h.value,"onUpdate:modelValue":e[14]||(e[14]=u=>h.value=u),"max-width":"500"},{default:a(()=>[l(H,null,{default:a(()=>[l(te,{class:"text-center px-10 py-6"},{default:a(()=>[l(M,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:a(()=>[l(Ce,{icon:"tabler-check",size:"38"})]),_:1}),r("h1",Ye,C(L.value),1),r("p",null,C(v.value),1),l(M,{color:"success",onClick:e[13]||(e[13]=u=>ie())},{default:a(()=>[b(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:S.value,"onUpdate:modelValue":e[15]||(e[15]=u=>S.value=u),"max-width":"500"},{default:a(()=>[l(H,null,{default:a(()=>[l(te,{class:"text-center px-10 py-6"},{default:a(()=>[l(M,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:a(()=>[Ze]),_:1}),r("h1",el,C(m.value),1),r("p",null,C(y.value),1),l(M,{color:"success",onClick:ie},{default:a(()=>[b(" Ok ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Dl=fe(ll,[["__scopeId","data-v-1f931cd8"]]);export{Dl as _,hl as a};
