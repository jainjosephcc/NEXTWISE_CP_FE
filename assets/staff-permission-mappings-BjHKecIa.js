import{_ as q}from"./ConfirmDialog-CImc2dHV.js";import{e as J}from"./apiUtils-BdosomC5.js";import{$ as E}from"./api-wE93wIMu.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as H,a as A}from"./VRow-DcfChc3a.js";import{V as O}from"./VDialog-BldaqJjN.js";import{V as y,a as Q}from"./VCard-C_R7hSZu.js";import{V as R}from"./VCardTitle-D4KXAsEB.js";import{V as x}from"./VCardText-DxS0I0_1.js";import{a as Y,b as Z,V as ee}from"./VList-Dlz-Yjq0.js";import{V as se}from"./VChip-LXx84AeF.js";import{r as l,w as te,E as oe,o as n,c as p,b as e,e as s,t as c,f,F as I,h as T,v as r,d as i,$ as M,ah as _,y as ae,b9 as le,ba as ie}from"./index-JiK_MWJ9.js";import{c as ne,V as re,a as ue,b as ce}from"./VExpansionPanel-D7aPSUAq.js";import{V as de}from"./VDivider-BRZJMS0Y.js";import{V as me}from"./VTable-DtrB5uIx.js";import{V as pe}from"./VCheckbox-Cyr_f3W9.js";import{V as z}from"./VSkeletonLoader-CJ48hQXm.js";import"./useApi-D4ZCxB9E.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VOverlay-Bhx_dkBk.js";import"./easing-CjukEv2V.js";import"./lazy-DgJxH81m.js";import"./scopeId-DQ1Gph4y.js";import"./transition-Bref35qS.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-PQIddCIO.js";import"./createSimpleFunctional-BcQORArf.js";import"./VAvatar-C3czt143.js";import"./VImg-BIMJWdw_.js";import"./index-BluCuHcE.js";import"./ssrBoot-DxW6z2IS.js";import"./VSlideGroup-m9bzUaex.js";import"./VCheckboxBtn-BYpk2bQ-.js";import"./VSelectionControl-rF_9ErQo.js";import"./form-KTljIkDW.js";import"./VInput-BlKbvnNP.js";const fe=v=>(le("data-v-aef195c7"),v=v(),ie(),v),_e={class:"d-flex align-center gap-x-2"},ve={class:"text-body-1"},Ve={class:"d-flex align-center justify-space-between"},ge={key:0},he=fe(()=>i("span",{class:"text-5xl font-weight-light"},"X",-1)),be={class:"text-h4 mb-4"},ye={class:"text-h4 mb-4"},xe={__name:"staff-permission-mappings",setup(v){const S=l(null),V=l([]),C=l(null),g=l([]),u=l([]);l(null),l(!0);const k=l(!1),h=l(!1),P=l(!1),w=l(""),D=l(""),G=l(""),L=l(""),B=async()=>{await J("getStaffGroups",S)};te(S,async a=>{if(a&&(V.value=a.groups,V.value.length>0)){const t=V.value[0].id;C.value=t,await $(t)}});const $=async a=>{g.value=[],u.value=[];try{const t=await E(`/getStaffGroupPermissions/${a}`,{method:"GET"});if(t&&t.selected_permission)u.value=t.selected_permission.map(o=>o.id);else{console.error("Selected permissions data not found:",t);return}const m=await E("/getStaffGroupPermissions/0",{method:"GET"});if(m&&m.permission){const d=m.permission.map(b=>{const U=Object.values(b.permission);return{...b,permission:U}});g.value=d}else console.error("All permissions data not found:",m)}catch(t){console.error("Error fetching staff group permission list:",t)}};oe(()=>{B()});const W=async a=>{C.value=a,await $(a)},j=a=>u.value.includes(a),F=a=>{u.value.includes(a)?u.value=u.value.filter(t=>t!==a):u.value.push(a)},K=async()=>{try{const a={groupId:C.value,selected_permissionname:u.value},t=await E("/storeAdminPermissions",{method:"POST",body:JSON.stringify(a)});t&&t.status===1?(G.value="Updated !",L.value="Admin Permission Updated Successfully !",P.value=!0):(w.value="Something Went Wrong !",D.value=t.message||"An error occurred.",h.value=!0)}catch(a){w.value="Something Went Wrong !",D.value=a.message||"An error occurred.",h.value=!0,console.error("Error updating admin permissions:",a)}},N=()=>{window.location.reload()};return(a,t)=>{const m=q;return n(),p("section",null,[e(H,null,{default:s(()=>[e(A,{cols:"4"},{default:s(()=>[e(y,null,{default:s(()=>[e(Q,null,{default:s(()=>[e(R,null,{default:s(()=>[c("USER GROUPS")]),_:1})]),_:1}),e(x,null,{default:s(()=>[S.value?(n(),f(ee,{key:0,class:"card-list"},{default:s(()=>[(n(!0),p(I,null,T(V.value,o=>(n(),f(Y,{key:o.id,value:o.id,onClick:d=>W(o.id)},{prepend:s(()=>[e(se,{label:!1,color:"success"},{default:s(()=>[c("#"+r(o.id),1)]),_:2},1024),e(Z,{class:"font-weight-medium me-2"},{default:s(()=>[c(r(o.group_name),1)]),_:2},1024)]),append:s(()=>[i("div",_e,[i("div",ve,r(o.total_members),1),e(M,{icon:"tabler-users-group"})])]),_:2},1032,["value","onClick"]))),128))]),_:1})):(n(),f(z,{key:1,type:"table-tbody"}))]),_:1})]),_:1})]),_:1}),e(A,{cols:"8"},{default:s(()=>[g.value?(n(),f(y,{key:0},{default:s(()=>[e(x,null,{default:s(()=>[i("div",Ve,[i("div",null,[e(R,null,{default:s(()=>[c("ALL PERMISSION MAPPING")]),_:1})]),i("div",null,[e(_,{class:"me-2 mb-4",onClick:t[0]||(t[0]=o=>k.value=!0)},{default:s(()=>[c("Update")]),_:1})])]),e(ne,null,{default:s(()=>[(n(!0),p(I,null,T(g.value,o=>(n(),f(re,{key:o.cat_id},{default:s(()=>[e(ue,null,{default:s(()=>[c(r(o.category_name),1)]),_:2},1024),e(ce,null,{default:s(()=>[e(de),e(me,{height:"400",class:"text-no-wrap"},{default:s(()=>[i("tbody",null,[(n(!0),p(I,null,T(o.permission,(d,b)=>(n(),p("tr",{key:b},[i("td",null,[e(pe,{"model-value":j(d.id),onChange:U=>F(d.id),label:d.permission_name},null,8,["model-value","onChange","label"])]),i("td",null,r(d.description),1)]))),128))])]),_:2},1024),o.permission.length?ae("",!0):(n(),p("p",ge,"No permissions found for this category."))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):(n(),f(z,{key:1,type:"table-tbody"}))]),_:1})]),_:1}),e(m,{isDialogVisible:k.value,"onUpdate:isDialogVisible":t[1]||(t[1]=o=>k.value=o),onConfirm:K,"confirmation-question":"Do you want to update staff permission?","cancel-title":"Cancelled","confirm-title":"Cancelled!"},null,8,["isDialogVisible"]),e(O,{modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=o=>h.value=o),"max-width":"500"},{default:s(()=>[e(y,null,{default:s(()=>[e(x,{class:"text-center px-10 py-6"},{default:s(()=>[e(_,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:s(()=>[he]),_:1}),i("h1",be,r(w.value),1),i("p",null,r(D.value),1),e(_,{color:"success",onClick:N},{default:s(()=>[c("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,{modelValue:P.value,"onUpdate:modelValue":t[4]||(t[4]=o=>P.value=o),"max-width":"500"},{default:s(()=>[e(y,null,{default:s(()=>[e(x,{class:"text-center px-10 py-6"},{default:s(()=>[e(_,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:s(()=>[e(M,{icon:"tabler-check",size:"38"})]),_:1}),i("h1",ye,r(G.value),1),i("p",null,r(L.value),1),e(_,{color:"success",onClick:t[3]||(t[3]=o=>N())},{default:s(()=>[c("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},is=X(xe,[["__scopeId","data-v-aef195c7"]]);export{is as default};
