import{_ as P}from"./ConfirmDialog-C6pWpFc6.js";import{_ as U}from"./CustomClientCardChip-Dg82H5q0.js";import{$ as g}from"./api-kcTwumKZ.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as z,a as A}from"./VRow-DV0Kfclu.js";import{V as f}from"./VCard-D8rimWt5.js";import{V as N}from"./VDialog-Bhp_2kpN.js";import{V as k}from"./VCardText-BnlhGx-4.js";import{V as K}from"./VCardTitle-CmK20BDt.js";import{r as n,E as q,o as V,c as w,d as e,b as l,e as a,F as S,t as m,ah as p,$ as x,f as H,y as X,h as J,v as r,bb as Q,b9 as Y,ba as Z}from"./index-Dx4ZPR9G.js";import{V as ee}from"./VTable-cFNcBjKV.js";import{V as le}from"./VAvatar-DAi-c36J.js";import{V as te}from"./VImg-De_LVaFp.js";import{V as ae}from"./VChip-cZpRGEB1.js";import"./permission-L9b2DVFJ.js";import"./VList-D1ht4q47.js";import"./index-D-37BZE9.js";import"./ssrBoot-CMUh88Ky.js";import"./createSimpleFunctional-BPruny8O.js";import"./VDivider-C9TzRthA.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VOverlay-DDl4yNLU.js";import"./easing-CjukEv2V.js";import"./lazy-2YjBGDnA.js";import"./scopeId-Dnp8RDYF.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-muHaOPgE.js";import"./VSlideGroup-CFYqWIA9.js";const L=_=>(Y("data-v-44704062"),_=_(),Z(),_),se={class:"d-flex mb-6"},oe={class:"d-flex align-center justify-space-between"},ne=L(()=>e("thead",null,[e("tr",null,[e("th",null,"MT5ID"),e("th",null,"ID"),e("th",null,"CLIENET NAME"),e("th",null,"LOSABLE"),e("th",null,"NON LOSABLE"),e("th",null,"BALANCE"),e("th",null,"CREDIT"),e("th",null,"LAST FETCHED"),e("th",null,"ACTION")])],-1)),re={style:{"block-size":"100px","inline-size":"60px"},class:"d-flex flex-column justify-center align-center cursor-pointer rounded py-4 px-5 me-4"},ie={class:"text-h4 mb-4"},ue=L(()=>e("span",{class:"text-5xl font-weight-light"},"X",-1)),de={class:"text-h4 mb-4"},ce={__name:"credit-manager",setup(_){const c=n([]),B=n(null),b=n(!1),y=n(null),I=n(null),C=n(""),D=n(""),T=n(""),E=n(""),v=n(!1),h=n(!1),u=n(!1),$=async()=>{try{u.value=!0;const s=await g("meta-credit-manager/list",{method:"GET"});s&&(c.value=s.data)}catch(s){console.error("Error fetching credit data:",s),B.value=s}finally{u.value=!1}},O=async s=>{try{u.value=!0;const o=await g(`meta-credit-manager/mt-info/${s}`,{method:"GET"});if(o){const i=o.data,d=c.value.findIndex(t=>t.mt5_id===s);d!==-1&&(c.value[d]={...c.value[d],...i})}}catch(o){console.error(`Error fetching data for MT5 ID: ${s}`,o)}finally{u.value=!1}},R=async()=>{var s,o;try{u.value=!0,await g("meta-credit-manager/mt-info/update-all",{method:"GET"})&&(C.value="Data Refreshed!",D.value="All MT5 credit data has been refreshed successfully!",v.value=!0)}catch(i){console.error("Error refreshing all MT5 data:",i),T.value="Something Went Wrong!",E.value=((o=(s=i.response)==null?void 0:s._data)==null?void 0:o.message)||"Error occurred",h.value=!0}finally{u.value=!1}},F=s=>{y.value=s.id,I.value=s.mt5_id,b.value=!0},W=async s=>{var o,i;if(s)try{await g("meta-credit-manager/delete",{method:"POST",body:{id:y.value,mt5_id:I.value}})&&(c.value=c.value.filter(t=>t.id!==y.value),C.value="Deleted!",D.value="Credit entry deleted successfully!",v.value=!0)}catch(d){T.value="Something Went Wrong!",E.value=((i=(o=d.response)==null?void 0:o._data)==null?void 0:i.message)||"Error occurred",h.value=!0}},M=()=>{window.location.reload()};return q(()=>{$()}),(s,o)=>{const i=U,d=P;return V(),w(S,null,[e("section",null,[e("div",se,[l(z,null,{default:a(()=>[l(A,{cols:"12"},{default:a(()=>[l(f,null,{default:a(()=>[l(k,null,{default:a(()=>[e("div",oe,[l(K,null,{default:a(()=>[m(" Credit Manager ")]),_:1}),e("div",null,[l(p,{class:"me-2",onClick:R,disabled:u.value},{default:a(()=>[l(x,{icon:"tabler-refresh"}),m("Refresh Data "),u.value?(V(),H(Q,{key:0,indeterminate:"",size:"24",class:"ms-2"})):X("",!0)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1})]),_:1})]),l(f,{class:"mb-6"},{default:a(()=>[l(z,null,{default:a(()=>[l(A,{cols:"12"},{default:a(()=>[l(f,null,{default:a(()=>[l(ee,{height:"800","fixed-header":"",class:"text-no-wrap"},{default:a(()=>[ne,e("tbody",null,[(V(!0),w(S,null,J(c.value,t=>(V(),w("tr",{key:t.id},[e("td",null,[e("div",re,[l(le,{rounded:"",size:"45",variant:"tonal",class:"mb-2 ps-1 pe-1"},{default:a(()=>[l(te,{src:"/images/svg/mt5_lined.svg",size:"22"})]),_:1}),m(" "+r(t.mt5_id),1)])]),e("td",null,[l(ae,{size:"x-small"},{default:a(()=>[m(r(t.id),1)]),_:2},1024)]),e("td",null,[l(i,{client_name:t.client_name,client_id:t.client_id,email:t.email},null,8,["client_name","client_id","email"])]),e("td",null,r(t.losable),1),e("td",null,r(t.non_losable),1),e("td",null,r(t.balance),1),e("td",null,r(t.credit),1),e("td",null,r(t.last_fetched_at?t.last_fetched_at:"Never Fetched"),1),e("td",null,[l(x,{icon:"tabler-refresh",class:"me-2",onClick:G=>O(t.mt5_id)},null,8,["onClick"]),l(x,{icon:"tabler-trash",onClick:G=>F(t)},null,8,["onClick"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),l(d,{isDialogVisible:b.value,"onUpdate:isDialogVisible":o[0]||(o[0]=t=>b.value=t),onConfirm:W,"confirmation-question":"Are you sure you want to delete this credit?","cancel-title":"Cancel","confirm-title":"Delete!"},null,8,["isDialogVisible"]),l(N,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=t=>v.value=t),"max-width":"500"},{default:a(()=>[l(f,null,{default:a(()=>[l(k,{class:"text-center px-10 py-6"},{default:a(()=>[l(p,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px"}},{default:a(()=>[l(x,{icon:"tabler-check",size:"38"})]),_:1}),e("h1",ie,r(C.value),1),e("p",null,r(D.value),1),l(p,{color:"success",onClick:M},{default:a(()=>[m("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(N,{modelValue:h.value,"onUpdate:modelValue":o[2]||(o[2]=t=>h.value=t),"max-width":"500"},{default:a(()=>[l(f,null,{default:a(()=>[l(k,{class:"text-center px-10 py-6"},{default:a(()=>[l(p,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px"}},{default:a(()=>[ue]),_:1}),e("h1",de,r(T.value),1),e("p",null,r(E.value),1),l(p,{color:"success",onClick:M},{default:a(()=>[m("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},We=j(ce,[["__scopeId","data-v-44704062"]]);export{We as default};
