import{p as K}from"./formatters-MfVJSZma.js";import{_ as L}from"./ConfirmDialog-2HfV989T.js";import{_ as q}from"./AppTextField-BaVqu4jK.js";import{_ as H}from"./AppDateTimePicker-B5X2YrUN.js";import{_ as J}from"./CustomStaffCardChip-CDfRdCbt.js";import{$ as C}from"./api-BaRI-q-y.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Q,a as Z}from"./VRow-BrBOniq2.js";import{V,b as ee}from"./VCard-DScfi5So.js";import{V as N}from"./VDialog-DO1lt7PQ.js";import{V as T}from"./VCardText-DIMXcuil.js";import{V as te}from"./VAvatar-B9FI6N68.js";import{r as n,w as ae,E as le,a5 as A,o as c,c as p,d as a,b as l,e as o,F as S,h as k,f as F,v as r,x as oe,m as h,y as se,a0 as I,t as _,ai as g,b9 as re,ba as ne}from"./index-VIgWIw9z.js";import{V as ie}from"./VCardTitle-DN6VETOB.js";import{V as ce}from"./VDivider-C0ssATun.js";import{V as de}from"./VChip-D7Zky-hd.js";import{V as ue}from"./VTable-CM4FBYo2.js";import{V as me}from"./VSkeletonLoader-COCwKVaa.js";import"./helpers-DK5QwNv0.js";import"./form-D5earr4N.js";import"./VTextField-Bkm-lU-B.js";/* empty css                   */import"./VCounter-DELH-t7W.js";import"./index-CyI2hWI8.js";import"./transition-CZ13CYou.js";import"./VField-CGsPVke0.js";import"./easing-CjukEv2V.js";import"./VInput-C2xQUOvp.js";import"./forwardRefs-C-GTDzx5.js";import"./VImg-BQR-30dM.js";import"./permission-B0BZvmkn.js";import"./VList-Bn5a5y5R.js";import"./ssrBoot-BLlZaoP9.js";import"./createSimpleFunctional-CCI-bGJ3.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VOverlay-DKlk4GO4.js";import"./lazy-fDnYxLbP.js";import"./scopeId-BZPXlNMJ.js";import"./dialog-transition-BzBIeMyZ.js";import"./VSlideGroup-DVSDBfNI.js";const W=v=>(re("data-v-a0662bbd"),v=v(),ne(),v),fe={class:"d-flex mb-6"},pe={class:"d-flex justify-space-between"},_e={class:"d-flex flex-column gap-y-1"},he={class:"text-body-1 text-high-emphasis"},ge={class:"d-flex gap-x-2 align-center"},ve={class:"text-h5"},ye={class:"text-sm"},Ve={class:"d-flex align-center justify-space-between"},xe={class:"mb-2"},be=W(()=>a("thead",null,[a("tr",null,[a("th",null,"#ID"),a("th",null,"Name/Email"),a("th",null,"Team"),a("th",null,"Role"),a("th",null,"Month & Year"),a("th",null,"Target")])],-1)),De={class:"text-caption me-0 ms-0",style:{"padding-left":"2px"}},we={key:2},Ce=W(()=>a("span",{class:"text-5xl font-weight-light"},"X",-1)),Te={class:"text-h4 mb-4"},Se={class:"text-h4 mb-4"},ke={__name:"staff-targets",setup(v){const d=n({total_staff:0,managers:0,rms:0,total_clients:0}),u=n([]),P=new Date,B=`${new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(P)}`,m=n(B);n([]),n([]);const x=n(!1),y=n(!1),b=n(!1);let D=n(""),M=n(""),$=n(""),E=n("");const R=async()=>{try{const e=await C("/getTotalStaff",{method:"GET"});d.value.total_staff=e.all_staff_count,d.value.total_clients=e.total_clients,d.value.rms=e.relationship_manager_count,d.value.managers=e.managers_count}catch(e){console.error("Error fetching header data:",e)}},Y=async()=>{try{if(!m.value){console.warn("No date selected.");return}const e=new Date(m.value),s=`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}`,f=await C(`/getMonthlyTargetData/${s}`,{method:"GET"});f?u.value=f.staff_data||[]:console.warn("Monthly target data not found:",f)}catch(e){console.error("Error fetching specific monthly target data:",e)}};ae(m,(e,s)=>{e!==s&&Y()},{immediate:!0}),le(()=>{R()}),A(()=>u.value?u.value.map(e=>({id:e.id,staff_name:e.staff_name,email:e.email,role:e.role,team:e.team,year:e.year,target:e.target,month:e.month})):[]);const O=A(()=>[{title:"Total Staff",value:d.value.total_staff.toString(),change:29,desc:"Active Registered Clients",icon:"tabler-users",iconColor:"primary"},{title:"Managers",value:d.value.managers.toString(),change:18,desc:"Introducing Brokers",icon:"tabler-chart-arrows-vertical",iconColor:"warning"},{title:"Relationship Managers",value:d.value.rms,desc:"Approved Deposits",icon:"tabler-brand-cashapp",iconColor:"success"},{title:"Total Clients",value:d.value.total_clients,desc:"Approved Withdrawals",icon:"tabler-database-minus",iconColor:"danger"}]),j=async()=>{try{if(!m.value){console.warn("No date selected.");return}const e=new Date(m.value),f={date:`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}`,staff_list:u.value.map(i=>({id:i.id,staff_name:i.staff_name,profile_pic:i.profile_pic||"default_staff_image.png",email:i.email,role:i.role,team:i.team,target:i.target,month:i.month,year:i.year}))};await C("/updateMonthlyTarget",{method:"POST",body:JSON.stringify(f)})?($.value="Updated !",E.value="Monthly target data updated successfully !",b.value=!0):(D.value="Something Went Wrong !",y.value=!0)}catch(e){D.value="Something Went Wrong !",M.value=e.message||"An error occurred.",y.value=!0,console.error("Error updating monthly target data:",e)}},U=async e=>{window.location.reload()};return(e,s)=>{const f=H,z=q,i=L;return c(),p("section",null,[a("div",fe,[l(Q,null,{default:o(()=>[(c(!0),p(S,null,k(O.value,(t,w)=>(c(),F(Z,{key:w,cols:"12",md:"3",sm:"6"},{default:o(()=>[l(V,null,{default:o(()=>[l(T,null,{default:o(()=>[a("div",pe,[a("div",_e,[a("div",he,r(t.title),1),a("div",ge,[a("h5",ve,r(t.value),1),t.change?(c(),p("div",{key:0,class:oe(["text-base",t.change>0?"text-success":"text-error"])}," ("+r(("prefixWithPlus"in e?e.prefixWithPlus:h(K))(t.change))+"%) ",3)):se("",!0)]),a("div",ye,r(t.desc),1)]),l(te,{color:t.iconColor,variant:"tonal",rounded:"",size:"42"},{default:o(()=>[l(I,{icon:t.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l(V,null,{default:o(()=>[a("div",Ve,[a("div",xe,[l(ie,null,{default:o(()=>[_(" Staff Target Configurations ")]),_:1}),l(ee,{class:"pb-3"},{default:o(()=>[_("Month & Year")]),_:1}),l(f,{class:"ms-2",modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),label:"",placeholder:"Select date",config:{dateFormat:"F, Y",view:"month-year"},clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),a("div",null,[l(g,{class:"me-2",onClick:s[1]||(s[1]=t=>x.value=!0)},{default:o(()=>[_("UPDATE")]),_:1})])]),l(ce),u.value.length>0?(c(),F(ue,{key:0,height:"800",class:"text-no-wrap"},{default:o(()=>[be,a("tbody",null,[(c(!0),p(S,null,k(u.value,(t,w)=>(c(),p("tr",{key:w},[a("td",De,[l(de,{size:"x-small"},{default:o(()=>[_(r(t.id),1)]),_:2},1024)]),a("td",null,[l(J,{rm_name:t.staff_name,rm_id:t.id,rm_email:t.email},null,8,["rm_name","rm_id","rm_email"])]),a("td",null,r(t.team),1),a("td",null,r(t.role),1),a("td",null,r(t.month)+" "+r(t.year),1),a("td",null,[l(z,{modelValue:t.target,"onUpdate:modelValue":G=>t.target=G,suffix:"USD",placeholder:"target"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})):u.value.length===0?(c(),p(S,{key:1},k(3,t=>l(me,{key:t,type:"table-tbody"})),64)):(c(),p("p",we,"No data available"))]),_:1}),l(i,{isDialogVisible:x.value,"onUpdate:isDialogVisible":s[2]||(s[2]=t=>x.value=t),onConfirm:j,"confirmation-question":"Do you want to update staff target?","cancel-title":"Cancelled","confirm-title":"Cancelled!"},null,8,["isDialogVisible"]),l(N,{modelValue:y.value,"onUpdate:modelValue":s[3]||(s[3]=t=>y.value=t),"max-width":"500"},{default:o(()=>[l(V,null,{default:o(()=>[l(T,{class:"text-center px-10 py-6"},{default:o(()=>[l(g,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:o(()=>[Ce]),_:1}),a("h1",Te,r(h(D)),1),a("p",null,r(h(M)),1),l(g,{color:"success",onClick:U},{default:o(()=>[_(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(N,{modelValue:b.value,"onUpdate:modelValue":s[5]||(s[5]=t=>b.value=t),"max-width":"500"},{default:o(()=>[l(V,null,{default:o(()=>[l(T,{class:"text-center px-10 py-6"},{default:o(()=>[l(g,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:o(()=>[l(I,{icon:"tabler-check",size:"38"})]),_:1}),a("h1",Se,r(h($)),1),a("p",null,r(h(E)),1),l(g,{color:"success",onClick:s[4]||(s[4]=t=>U())},{default:o(()=>[_(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},ht=X(ke,[["__scopeId","data-v-a0662bbd"]]);export{ht as default};
