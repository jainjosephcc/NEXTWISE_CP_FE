import{h as k}from"./permission-CfJExeHF.js";import{f as de}from"./formatters-MfVJSZma.js";import{r as s,a4 as W,E as ce,w as pe,cn as _e,o as i,c as T,d as o,b as l,e as n,F as G,t as w,f as m,y as c,m as r,v as p,ah as q,$ as fe,h as ve,de as J}from"./index-JJLVR7gw.js";import{_ as he}from"./CLIENT_DepositTicketDialog-MXji6Fh2.js";import{_ as ye}from"./CustomTransactionStatusChip-ClMnAwZ0.js";import{_ as Ve}from"./CustomMT5Chip-1nlN-VM8.js";import{_ as ge}from"./CustomStaffCardChip-DmdgPtoH.js";import{_ as be}from"./CustomClientCardChip-FEO0xkvU.js";import{_ as De}from"./AppTextField-C3KG0Fdx.js";import{_ as Te}from"./AppDateTimePicker-LmbzkjiI.js";import{_ as we}from"./CustomManagerSelectWidget-DcLKN_Yb.js";import{_ as Ce}from"./AppSelect-Dk8olbt1.js";import{_ as Se}from"./CustomPageHeaderWidget-CWncpySJ.js";import{b as Ae,d as U,p as $}from"./apiUtils-BkqVA9aH.js";import{$ as K}from"./api-BTN9-S1a.js";import{V as ke}from"./VCard-DZWvGmgS.js";import{V as M}from"./VCardText-U-O62k8O.js";import{V as I}from"./VDivider-DXXBACNJ.js";import{V as Me,a as C}from"./VRow-CgtR2C0a.js";import{V as xe}from"./VSpacer-CYQf44YG.js";import{V as X}from"./VChip-Dj7sIaLu.js";import{V as Y}from"./VSkeletonLoader-Dr1oL0B2.js";import{V as Pe}from"./VTable-3BS_25Ta.js";import{V as Ee}from"./VPagination-idud2wyG.js";import"./helpers-DK5QwNv0.js";import"./ConfirmDialog-BAzm0IhP.js";import"./VDialog-v0wQo-Em.js";import"./VOverlay-yE6I3_jC.js";import"./easing-CjukEv2V.js";import"./lazy-amXKMzDk.js";import"./scopeId-ClaAXU-I.js";import"./transition-C2_fb7u_.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-OOY4pNuk.js";import"./DialogCloseBtn-CGSccGdU.js";import"./md5-B0uU80qf.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VCardTitle-BiC992U8.js";import"./createSimpleFunctional-C_BTfS6z.js";import"./VForm-CCOcmvzZ.js";import"./form-C0qhxlI3.js";import"./VRadioGroup-DU8d2sbj.js";import"./VSelectionControl-DEc2CGt5.js";import"./VInput-DlxzUbVk.js";import"./index-GgA-9tW3.js";import"./VList-oRE7i2Tp.js";import"./ssrBoot-BZxQaRBH.js";import"./VAvatar-yCqntSJd.js";import"./VImg-KnL00SIm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-D_u6fdPg.js";/* empty css                   */import"./VCounter-QpKNLAUU.js";import"./VField-CtxTuAgP.js";import"./VSelect-DolNbEcz.js";import"./VMenu-D0jACTlk.js";import"./VCheckboxBtn-XGtVXTYy.js";import"./useApi-7LUECuUp.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VSlideGroup-Cz4KrcLa.js";const Ne={class:"me-3 d-flex gap-3"},Ue={style:{"inline-size":"15.625rem"}},$e={class:"me-3 d-flex gap-3"},Ie={style:{"inline-size":"15.625rem"}},Be={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Le={class:"card-subtitle pt-3"},Oe=o("th",null,null,-1),Fe=o("th",null," NAME|EMAIL ",-1),Re=o("th",null," ASSIGNED RM ",-1),ze=o("th",null," TO ",-1),je=o("th",null," REQ.AMNT ",-1),He=o("th",null," APP.AMNT ",-1),Qe=o("th",null," METHOD ",-1),We=o("th",null," STATUS ",-1),Ge={key:0},qe={class:"text-caption me-0 ms-0 px-0 py-0",style:{"padding-left":"2px"}},Je=o("br",null,null,-1),Ke=o("span",{class:"text-caption text-xs"},"RM NOT MAPPED",-1),Xe={key:0},Ye={class:"d-flex flex-wrap justify-center justify-sm-space-between gap-y-2 mt-2"},rl={__name:"deposit-list",setup(Ze){const _=s(""),f=s(""),Z=s(null),v=s(null),ee=s(null),h=s(null),y=s(null),te=s(null),V=s(null),g=s(null);s(null);const b=s(null),B=s(null),x=[{title:"All",value:null},{title:"Pending",value:"0"},{title:"On Hold",value:"1"},{title:"Rejected",value:"2"},{title:"Approved",value:"3"}],L=s(20),S=s(1),le=s(null),oe=s(null),D=s(null),O=async()=>{D.value=null;const t=await K("/transactions/deposit-listing",{method:"POST",body:{page:S.value,deposit_status:v.value,currency:h.value,payment_method:y.value,manager:b.value,keyword:_.value,mt5id:f.value,from_date:V.value,to_date:g.value,bonus_percentage:B.value},onResponseError({response:a}){}});D.value=t},F=W(()=>{var t;return((t=D.value)==null?void 0:t.transaction_details.data)||[]}),P=W(()=>{var t;return((t=D.value)==null?void 0:t.transaction_details.total)||0}),E=s(!1),R=s("xlsx"),ae=async()=>{E.value=!0;try{const t=await K("/transactions/deposit-listing/download",{method:"POST",responseType:"blob",body:{deposit_status:v.value,currency:h.value,payment_method:y.value,manager:b.value,keyword:_.value,mt5id:f.value,from_date:V.value,to_date:g.value,bonus_percentage:B.value,format:R.value},onResponseError({response:d}){}}),a=new Blob([t],{type:t.type}),A=t.headers.get("Content-Disposition");let u="deposit_listing."+R.value;if(A){const d=A.match(/filename="?(.+)"?/);d&&d.length===2&&(u=d[1])}saveAs(a,u)}catch(t){console.error("Download failed:",t)}finally{E.value=!1}};ce(async()=>{await Ae(),await O()}),pe([S,L,Z,f,V,g,b,v,ee,h,y,te,_,le,oe],()=>{O()},{deep:!0,immediate:!1}),_e(()=>{}),s(!1);const N=s(!1),z=s(null);function se(t){z.value=t,N.value=!0}return(t,a)=>{const A=Se,u=Ce,d=we,j=Te,H=De,ne=be,ie=ge,re=Ve,me=ye,ue=he;return i(),T(G,null,[o("section",null,[l(A),l(ke,{class:"mb-6"},{default:n(()=>[l(M,{class:"py-4"},{default:n(()=>[w(" DEPOSIT LIST ")]),_:1}),l(I),l(M,null,{default:n(()=>[l(Me,null,{default:n(()=>[x&&x.length>0?(i(),m(C,{key:0,cols:"12",sm:"2"},{default:n(()=>[l(u,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),label:"Deposit Status",placeholder:"Deposit Status",items:x,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})):c("",!0),r(U)&&r(U).length>2?(i(),m(C,{key:1,cols:"12",sm:"2"},{default:n(()=>[l(u,{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value=e),label:"Deposited Currency",placeholder:"Deposited Currency",items:r(U),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):c("",!0),r($)&&r($).length>1?(i(),m(C,{key:2,cols:"12",sm:"2"},{default:n(()=>[l(u,{modelValue:y.value,"onUpdate:modelValue":a[2]||(a[2]=e=>y.value=e),label:"Payment Method",placeholder:"Payment Method",items:r($),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):c("",!0),("hasAccess"in t?t.hasAccess:r(k))("view_all_clients")||("hasAccess"in t?t.hasAccess:r(k))("view_my_team_clients")?(i(),m(d,{key:3,modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e)},null,8,["modelValue"])):c("",!0),l(C,{cols:"12",sm:"2"},{default:n(()=>[l(j,{modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=e=>V.value=e),label:"From Date",placeholder:"Select date",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(C,{cols:"12",sm:"2"},{default:n(()=>[l(j,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=e=>g.value=e),label:"To Date",placeholder:"Select date",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(I),l(M,{class:"d-flex flex-wrap gap-4"},{default:n(()=>[o("div",Ne,[o("div",Ue,[l(H,{modelValue:_.value,"onUpdate:modelValue":a[6]||(a[6]=e=>_.value=e),placeholder:"Search client by name/email"},null,8,["modelValue"])])]),o("div",$e,[o("div",Ie,[l(H,{modelValue:f.value,"onUpdate:modelValue":a[7]||(a[7]=e=>f.value=e),placeholder:"Search MT5 ID"},null,8,["modelValue"])])]),l(xe),o("div",Be,[o("p",Le,"TOTAL LISTED COUNT : "+p(P.value?P.value:0),1),l(q,{color:"primary",onClick:ae,loading:E.value},{default:n(()=>[l(fe,{left:""},{default:n(()=>[w("mdi-download")]),_:1}),w(" Download ")]),_:1},8,["loading"])])]),_:1}),l(I),D.value?(i(),m(Pe,{key:0,height:"800",class:"text-no-wrap"},{default:n(()=>[o("thead",null,[o("tr",null,[Oe,Fe,Re,ze,je,He,Qe,We,("hasAccess"in t?t.hasAccess:r(k))("view_deposit_details_page")?(i(),T("th",Ge," VIEW ")):c("",!0)])]),o("tbody",null,[F.value?(i(!0),T(G,{key:0},ve(F.value,e=>{var Q;return i(),T("tr",{class:"",key:e.transaction_id},[o("td",qe,[l(X,{size:"x-small"},{default:n(()=>[w(" #"+p(e.transaction_id),1)]),_:2},1024),Je,w(" "+p(("formatDateToMonthShort"in t?t.formatDateToMonthShort:r(de))(e.created_at)),1)]),o("td",null,[l(ne,{client_id:e.client_id,client_name:e.client_name,email:e.email},null,8,["client_id","client_name","email"])]),o("td",null,[e.manager_id?(i(),m(ie,{key:0,rm_id:e.manager_id,rm_name:e.rm_name},null,8,["rm_id","rm_name"])):(i(),m(X,{key:1,size:"x-small",variant:"outlined"},{default:n(()=>[Ke]),_:1}))]),o("td",null,[l(re,{client_id:e.client_id,mt_id:(Q=e.mt_id)==null?void 0:Q.toString(),is_wallet:e.is_wallet},null,8,["client_id","mt_id","is_wallet"])]),o("td",null,p(("formatCurrency"in t?t.formatCurrency:r(J))(e.amount_in_usd)),1),o("td",null,p(("formatCurrency"in t?t.formatCurrency:r(J))(e.approved_amount)),1),o("td",null,p(e.deposit_method),1),o("td",null,[l(me,{trans_status:e.status},null,8,["trans_status"])]),("hasAccess"in t?t.hasAccess:r(k))("view_deposit_details_page")?(i(),T("td",Xe,[l(q,{color:"secondary",size:"x-small",variant:"elevated",class:"px-2 me-2 rounded",icon:"tabler-file-description",onClick:et=>se(e)},null,8,["onClick"])])):c("",!0)])}),128)):(i(),m(Y,{key:1,type:"table-tbody"}))])]),_:1})):(i(),m(Y,{key:1,type:"table-tbody"})),l(M,{class:"pt-2"},{default:n(()=>[o("div",Ye,[l(Ee,{modelValue:S.value,"onUpdate:modelValue":a[8]||(a[8]=e=>S.value=e),"total-visible":t.$vuetify.display.smAndDown?3:5,length:Math.ceil(P.value/L.value)},null,8,["modelValue","total-visible","length"])])]),_:1})]),_:1})]),l(ue,{isDialogVisible:N.value,"onUpdate:isDialogVisible":a[9]||(a[9]=e=>N.value=e),selectedTransaction:z.value},null,8,["isDialogVisible","selectedTransaction"])],64)}}};export{rl as default};
