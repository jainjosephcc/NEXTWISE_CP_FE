import{p as fe,f as te}from"./formatters-MfVJSZma.js";import{h as y}from"./permission-Cle7PbYH.js";import{_ as ve}from"./ConfirmDialog-CImc2dHV.js";import{_ as ne}from"./AppSelect-CfgfDHHL.js";import{_ as ie}from"./AppTextField-DwceRF1z.js";import{_ as _e}from"./AppDrawerHeaderSection-IjnkDEbw.js";import{P as he}from"./vue3-perfect-scrollbar.esm-D2bK4u2n.js";import{$ as Z}from"./api-wE93wIMu.js";import{V as ue}from"./VDivider-BRZJMS0Y.js";import{V as P}from"./VCard-C_R7hSZu.js";import{V as N}from"./VCardText-DxS0I0_1.js";import{V as j,a as c}from"./VRow-DcfChc3a.js";import{r as o,a4 as de,o as u,f as h,e as l,b as e,m,y as p,ah as U,t as E,$ as Y,d as i,v,a_ as ge,E as Ve,w as be,a as ye,c as _,F as se,h as oe,x as we,a$ as Se}from"./index-JiK_MWJ9.js";import{V as re}from"./VDialog-BldaqJjN.js";import{V as Ae}from"./VNavigationDrawer-CMYHIK5b.js";import{_ as ke}from"./CustomStaffCardChip-DeeXzbPh.js";import{V as Ce}from"./VAvatar-C3czt143.js";import{V as De}from"./VCardTitle-D4KXAsEB.js";import{V as xe}from"./VChip-LXx84AeF.js";import{V as Le}from"./VTable-DtrB5uIx.js";import{V as Te}from"./VSkeletonLoader-CJ48hQXm.js";import"./helpers-DK5QwNv0.js";import"./form-KTljIkDW.js";import"./VSelect-DtGzLhSn.js";import"./VTextField-DyzuL7G8.js";/* empty css                   */import"./VCounter-BfvrGfZv.js";import"./index-BluCuHcE.js";import"./transition-Bref35qS.js";import"./VField-uySpVFbK.js";import"./easing-CjukEv2V.js";import"./VInput-BlKbvnNP.js";import"./forwardRefs-C-GTDzx5.js";import"./VImg-BIMJWdw_.js";import"./VList-Dlz-Yjq0.js";import"./ssrBoot-DxW6z2IS.js";import"./createSimpleFunctional-BcQORArf.js";import"./dialog-transition-PQIddCIO.js";import"./VMenu-BK7cWoAk.js";import"./VOverlay-Bhx_dkBk.js";import"./lazy-DgJxH81m.js";import"./scopeId-DQ1Gph4y.js";import"./VCheckboxBtn-BYpk2bQ-.js";import"./VSelectionControl-rF_9ErQo.js";import"./VSpacer-FUnwweiR.js";/* empty css              */import"./index-B3bPRkoL.js";import"./VSlideGroup-m9bzUaex.js";const Me={class:"text-h4 mb-4"},Ee=i("span",{class:"text-5xl font-weight-light"},"X",-1),Oe={class:"text-h4 mb-4"},Ue={__name:"AddStaffDialog",props:{isDrawerOpen:{type:Boolean,required:!0},groupsList:{type:Object,required:!0},teamsList:{type:Object,required:!0},rolesList:{type:Object,required:!0}},emits:["update:isDrawerOpen","userData"],setup(k,{emit:g}){const w=o(!1),V=o(!1),C=o(),D=o(""),x=o(""),L=o(""),S=o(""),A=o(""),T=o(!1),q=o(!1),M=o(!1),G=o(!1),H=o(null);let a=o(""),r=o(""),W=o(""),$=o("");const z=o(null),F=o(""),I=o("");de(()=>S.value===A.value);const s=[{text:"Male",value:"Male"},{text:"Female",value:"Female"},{text:"Other",value:"Other"}],J=k,K=o(null),Q=o(null),X=o(null),ee=g,me=d=>{ee("update:isDrawerOpen",d)},f={required:d=>!!d||"Required.",min:d=>d.length>=8||"Min 8 characters",capital:d=>/[A-Z]/.test(d)||"Min 1 uppercase letter",small:d=>/[a-z]/.test(d)||"Min 1 lowercase letter",special:d=>/[!@#$%^&*(),.?":{}|<>]/.test(d)||"Min 1 special character",number:d=>/[0-9]/.test(d)||"Min 1 number",email:d=>/.+@.+\..+/.test(d)||"E-mail must be valid"},le=()=>{ee("update:isDrawerOpen",!1),ge(()=>{var d,t;(d=C.value)==null||d.reset(),(t=C.value)==null||t.resetValidation()})},ce=async d=>{var t;if(d){M.value=!0,F.value="",I.value="";try{await Z("/addManger",{method:"POST",body:{staff_name:D.value,email:x.value,password:S.value,password_confirmation:A.value,contact_no:L.value,gender:z.value,group_id:K.value,role_id:X.value,team_id:Q.value},onResponseError({response:b}){var O;if(console.log("Error Response:",b),b.status===422){const R=b._data.errors||{};F.value=R.email?R.email[0]:"",I.value=R.contact_no?R.contact_no[0]:"",M.value=!1;return}a.value="Something Went Wrong!",r.value=((O=b._data)==null?void 0:O.message)||"Unknown error",T.value=!0,M.value=!1}})&&(W.value="Success!",$.value="Staff Created Successfully!",q.value=!0)}catch(B){console.log("Exception Error:",B),a.value="Something Went Wrong!",r.value=((t=B.data)==null?void 0:t.message)||"Unknown error",T.value=!0,M.value=!1}}},ae=async d=>{window.location.reload()};function pe(){H.value=!0,G.value=!0}return(d,t)=>{const B=_e,b=ie,O=ne,R=ve;return u(),h(Ae,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":J.isDrawerOpen,"onUpdate:modelValue":me},{default:l(()=>[e(B,{title:"Add New Staff",onCancel:le}),e(ue),e(m(he),{options:{wheelPropagation:!1}},{default:l(()=>[e(P,{flat:""},{default:l(()=>[e(N,null,{default:l(()=>[e(j,null,{default:l(()=>[e(c,{cols:"12"},{default:l(()=>[e(b,{modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=n=>D.value=n),rules:[f.required],label:"Full Name",placeholder:"Enter your full name"},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(b,{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=n=>x.value=n),rules:[f.required,f.email],"error-messages":F.value,label:"Email",placeholder:"Enter your email id"},null,8,["modelValue","rules","error-messages"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(b,{modelValue:L.value,"onUpdate:modelValue":t[2]||(t[2]=n=>L.value=n),type:"number",rules:[f.required],"error-messages":I.value,label:"Contact",placeholder:"Enter contact number"},null,8,["modelValue","rules","error-messages"])]),_:1}),e(c,{cols:"12",sm:"12"},{default:l(()=>[e(b,{modelValue:S.value,"onUpdate:modelValue":t[3]||(t[3]=n=>S.value=n),rules:[f.required,f.min,f.capital,f.small,f.special],"append-inner-icon":w.value?"tabler-eye-off":"tabler-eye",type:w.value?"text":"password",name:"input-10-2",placeholder:"············",label:"Enter Password",hint:"At least 8 characters","onClick:appendInner":t[4]||(t[4]=n=>w.value=!w.value)},null,8,["modelValue","rules","append-inner-icon","type"])]),_:1}),e(c,{cols:"12",sm:"12"},{default:l(()=>[e(b,{modelValue:A.value,"onUpdate:modelValue":t[5]||(t[5]=n=>A.value=n),rules:[f.required,f.min,f.capital,f.small,f.special],"append-inner-icon":V.value?"tabler-eye-off":"tabler-eye",type:V.value?"text":"password",name:"input-10-2",placeholder:"············",label:"Confirm Password","onClick:appendInner":t[6]||(t[6]=n=>V.value=!V.value)},null,8,["modelValue","rules","append-inner-icon","type"])]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(O,{modelValue:z.value,"onUpdate:modelValue":t[7]||(t[7]=n=>z.value=n),items:s,"item-title":"text","item-value":"value",label:"Gender","single-line":""},null,8,["modelValue"])]),_:1}),k.teamsList?(u(),h(c,{key:0,cols:"12"},{default:l(()=>[e(O,{label:"Select Staff Teams",modelValue:Q.value,"onUpdate:modelValue":t[8]||(t[8]=n=>Q.value=n),placeholder:"Team",items:k.teamsList,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0),k.rolesList?(u(),h(c,{key:1,cols:"12"},{default:l(()=>[e(O,{label:"Select Roles",modelValue:X.value,"onUpdate:modelValue":t[9]||(t[9]=n=>X.value=n),placeholder:"Role",items:k.rolesList,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0),k.groupsList?(u(),h(c,{key:2,cols:"12"},{default:l(()=>[e(O,{label:"Select Permission Group",modelValue:K.value,"onUpdate:modelValue":t[10]||(t[10]=n=>K.value=n),placeholder:"Group",items:k.groupsList,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0),e(c,{cols:"12"},{default:l(()=>[e(U,{class:"me-3",onClick:t[11]||(t[11]=n=>pe()),loading:M.value},{default:l(()=>[E(" Submit ")]),_:1},8,["loading"]),e(U,{type:"reset",variant:"tonal",color:"error",onClick:le},{default:l(()=>[E(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{isDialogVisible:G.value,"onUpdate:isDialogVisible":t[12]||(t[12]=n=>G.value=n),onConfirm:ce,"confirmation-question":"Are you sure you want to add this staff?","cancel-title":"Cancelled","confirm-title":"Confirmed!"},null,8,["isDialogVisible"]),e(re,{modelValue:q.value,"onUpdate:modelValue":t[14]||(t[14]=n=>q.value=n),"max-width":"500"},{default:l(()=>[e(P,null,{default:l(()=>[e(N,{class:"text-center px-10 py-6"},{default:l(()=>[e(U,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:l(()=>[e(Y,{icon:"tabler-check",size:"38"})]),_:1}),i("h1",Me,v(m(W)),1),i("p",null,v(m($)),1),e(U,{color:"success",onClick:t[13]||(t[13]=n=>ae())},{default:l(()=>[E("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(re,{modelValue:T.value,"onUpdate:modelValue":t[15]||(t[15]=n=>T.value=n),"max-width":"500"},{default:l(()=>[e(P,null,{default:l(()=>[e(N,{class:"text-center px-10 py-6"},{default:l(()=>[e(U,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:l(()=>[Ee]),_:1}),i("h1",Oe,v(m(a)),1),i("p",null,v(m(r)),1),e(U,{color:"success",onClick:ae},{default:l(()=>[E("Ok")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}},$e={class:"d-flex mb-6"},Re={class:"d-flex justify-space-between"},Pe={class:"d-flex flex-column gap-y-1"},Ne={class:"text-body-1 text-high-emphasis"},qe={class:"d-flex gap-x-2 align-center"},Ge={class:"text-h5"},ze={class:"text-sm"},Fe={class:"d-flex mb-6"},Ie={class:"d-flex align-center justify-space-between"},Be={key:0},We=i("th",null," Joined On ",-1),je=i("th",null," NAME/EMAIL ",-1),He=i("th",null," LAST LOGGED-IN ",-1),Je={key:0},Ke={key:1},Qe={key:2},Xe=i("th",null," ACTIONS ",-1),Ze={class:"text-caption me-0 ms-0",style:{"padding-left":"2px"}},Ye=i("br",null,null,-1),el={key:0},ll={key:1},al={key:2},Xl={__name:"staff-list",setup(k){const g=o({total_staff:0,managers:0,rms:0,total_clients:0}),w=o(null),V=o(null),C=o(null),D=o(null),x=o(""),L=o(null),S=o(null),A=o(null),T=o(!1),q=async()=>{const a=await Z("/staff/staff-filter-headers",{method:"GET",onResponseError({response:r}){console.log(r)}});g.value.total_staff=a.all_staff_count,g.value.total_clients=a.total_clients,g.value.rms=a.relationship_manager_count,g.value.managers=a.managers_count,V.value=a.roles.map(r=>({title:r.role_name,value:r.id})),C.value=a.groups.map(r=>({title:r.group_name,value:r.id})),D.value=a.teams.map(r=>({title:r.team_name,value:r.id}))},M=async()=>{const a=await Z("/staff/staff-list",{method:"POST",body:{keyword:x.value,groupId:L.value,teamId:S.value,roleId:A.value},onResponseError({response:r}){console.log(r)}});w.value=await a.result.staff_list};Ve(async()=>{q(),M()}),be([x,A,L,S],()=>{M()},{deep:!0,immediate:!1});const G=de(()=>[{title:"Total Staff",value:g.value.total_staff.toString(),desc:"Added Staffs",icon:"tabler-users",iconColor:"primary"},{title:"Managers",value:g.value.managers.toString(),desc:"Mapped as Managers",icon:"tabler-chart-arrows-vertical",iconColor:"warning"},{title:"Relationship Managers",value:g.value.rms,desc:"Normal RMs",icon:"tabler-user-bolt",iconColor:"success"},{title:"Total Clients",value:g.value.total_clients,desc:"Registered Clients Count",icon:"tabler-user-dollar",iconColor:"danger"}]);function H(){T.value=!0}return(a,r)=>{const W=ie,$=ne,z=ke,F=ye("RouterLink"),I=Ue;return u(),_("section",null,[i("div",$e,[e(j,null,{default:l(()=>[(u(!0),_(se,null,oe(G.value,(s,J)=>(u(),h(c,{key:J,cols:"12",md:"3",sm:"6"},{default:l(()=>[e(P,null,{default:l(()=>[e(N,null,{default:l(()=>[i("div",Re,[i("div",Pe,[i("div",Ne,v(s.title),1),i("div",qe,[i("h5",Ge,v(s.value),1),s.change?(u(),_("div",{key:0,class:we(["text-base",s.change>0?"text-success":"text-error"])}," ("+v(("prefixWithPlus"in a?a.prefixWithPlus:m(fe))(s.change))+"%) ",3)):p("",!0)]),i("div",ze,v(s.desc),1)]),e(Ce,{color:s.iconColor,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[e(Y,{icon:s.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),i("div",Fe,[e(j,null,{default:l(()=>[e(c,{cols:"12"},{default:l(()=>[e(P,null,{default:l(()=>[e(N,null,{default:l(()=>[i("div",Ie,[i("div",null,[e(De,null,{default:l(()=>[E(" Staff List ")]),_:1})]),("hasAccess"in a?a.hasAccess:m(y))("add_staff")?(u(),_("div",Be,[e(U,{class:"me-2",onClick:r[0]||(r[0]=s=>H())},{default:l(()=>[E(" Add Staff")]),_:1})])):p("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),e(P,{class:"mb-6"},{default:l(()=>[e(N,null,{default:l(()=>[e(j,null,{default:l(()=>[e(c,{cols:"12",sm:"3"},{default:l(()=>[e(W,{modelValue:x.value,"onUpdate:modelValue":r[1]||(r[1]=s=>x.value=s),label:"Search by Name/Email",placeholder:"Search Staff"},null,8,["modelValue"])]),_:1}),D.value&&("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),h(c,{key:0,cols:"12",sm:"3"},{default:l(()=>[e($,{label:"Staff Teams",modelValue:S.value,"onUpdate:modelValue":r[2]||(r[2]=s=>S.value=s),placeholder:"Team",items:D.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0),V.value&&("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),h(c,{key:1,cols:"12",sm:"3"},{default:l(()=>[e($,{label:"Staff Roles",modelValue:A.value,"onUpdate:modelValue":r[3]||(r[3]=s=>A.value=s),placeholder:"Roles",items:V.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0),C.value&&("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),h(c,{key:2,cols:"12",sm:"3"},{default:l(()=>[e($,{label:"Permission Group",modelValue:L.value,"onUpdate:modelValue":r[4]||(r[4]=s=>L.value=s),placeholder:"Group",items:C.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):p("",!0)]),_:1})]),_:1}),e(ue),w.value?(u(),h(Le,{key:0,height:"800",class:"text-no-wrap"},{default:l(()=>[i("thead",null,[i("tr",null,[We,je,He,("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("th",Je," ROLE ")):p("",!0),("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("th",Ke," TEAM ")):p("",!0),("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("th",Qe," GROUP ")):p("",!0),Xe])]),i("tbody",null,[w.value?(u(!0),_(se,{key:0},oe(w.value,s=>(u(),_("tr",{class:"",key:s.id},[i("td",Ze,[e(xe,{size:"x-small"},{default:l(()=>[E(" #"+v(s.id),1)]),_:2},1024),Ye,E(" "+v(("formatDateToMonthShort"in a?a.formatDateToMonthShort:m(te))(s.created_at)),1)]),i("td",null,[e(z,{rm_id:s.id,rm_name:s.staff_name,rm_email:s.email},null,8,["rm_id","rm_name","rm_email"])]),i("td",null,v(("formatDateToMonthShort"in a?a.formatDateToMonthShort:m(te))(s.last_logged_in)),1),("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("td",el,v(s.role_name),1)):p("",!0),("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("td",ll,v(s.team_name),1)):p("",!0),("hasAccess"in a?a.hasAccess:m(y))("view_teams_groups")?(u(),_("td",al,v(s.group_name),1)):p("",!0),i("td",null,[e(F,{to:`/staff/staff-${s.id}-home-null-details`},{default:l(()=>[e(Y,{class:"ms-3",icon:"tabler-eye me-2"})]),_:2},1032,["to"])])]))),128)):(u(),h(Se,{key:1,indeterminate:"",color:"primary"}))])]),_:1})):(u(),h(Te,{key:1,type:"table-tbody"}))]),_:1}),C.value&&V.value?(u(),h(I,{key:0,isDrawerOpen:T.value,"onUpdate:isDrawerOpen":r[5]||(r[5]=s=>T.value=s),groupsList:C.value,teamsList:D.value,rolesList:V.value},null,8,["isDrawerOpen","groupsList","teamsList","rolesList"])):p("",!0)])}}};export{Xl as default};
