import{b as re}from"./formatters-MfVJSZma.js";import{r as c,bB as W,a4 as J,w as ee,o as v,c as K,b as e,e as t,t as o,d as a,v as u,b0 as ce,m as p,f as k,y as D,ah as y,$ as g,F as te,bg as ue,de as Q,x as N,dq as me,aV as _e}from"./index-JJLVR7gw.js";import{h as G}from"./permission-CfJExeHF.js";import{_ as fe}from"./ConfirmDialog-BAzm0IhP.js";import{_ as pe}from"./AppTextField-C3KG0Fdx.js";import{_ as ae}from"./CustomMT5Chip-1nlN-VM8.js";import{_ as se}from"./DialogCloseBtn-CGSccGdU.js";import{$ as Z}from"./api-BTN9-S1a.js";import{V as M}from"./VCard-DZWvGmgS.js";import{V as ve}from"./VCardTitle-BiC992U8.js";import{V as S}from"./VDivider-DXXBACNJ.js";import{V as ge}from"./VTable-3BS_25Ta.js";import{V as Te}from"./VForm-CCOcmvzZ.js";import{V as B}from"./VCardText-U-O62k8O.js";import{V as X,a as q}from"./VRow-CgtR2C0a.js";import{V as be}from"./VAlert-IJ09QIOf.js";import{V as F}from"./VDialog-v0wQo-Em.js";import{_ as he}from"./CustomTransactionStatusChip-ClMnAwZ0.js";import{_ as ye}from"./CustomStaffCardChip-DmdgPtoH.js";import{_ as Ve}from"./CustomClientCardChip-FEO0xkvU.js";import{a as f,b as x}from"./VList-oRE7i2Tp.js";import{V as O}from"./VAvatar-yCqntSJd.js";import{V as w}from"./VChip-Dj7sIaLu.js";const Ce=a("thead",null,[a("tr",null,[a("th",null,"MT5 ID"),a("th",null,"TRANSACTION TYPE")])],-1),xe={class:"text-h4 mb-4"},we=a("span",{class:"text-5xl font-weight-light"},"X",-1),De={class:"text-h4 mb-4"},Ae={__name:"EditAdjustTicketDialog",props:{isDialogVisible:{type:Boolean,required:!0},transaction_id:{type:Number,required:!0},selectedTransaction:{type:Object,required:!0}},emits:["update:isDialogVisible"],setup(L,{emit:P}){const s=c(!1),I=c(!1),T=c(!1),b=c(!1),h=c(""),n=c(""),m=c(""),U=c(""),R=c(!1),$=c(!1),j=c(0),V=c(0);c("");const i=L,z=P,C=_=>{z("update:isDialogVisible",_)},le=c(structuredClone(W(i.selectedTransaction))),Y=J(()=>i.selectedTransaction.transaction_type==="losable"?0:1),ne=J(()=>V.value>j.value),oe=async _=>{var l,A;if(_){R.value=!0;try{const d=await Z("/processCreditIn",{method:"POST",body:{adjustment_id:i.selectedTransaction.transaction_id,amount:V.value,type:Y.value,client_id:i.selectedTransaction.client_id,mt5id:i.selectedTransaction.mt_id,action:1},onResponseError({response:E}){h.value="Something Went Wrong!",n.value=E._data.message,T.value=!0}});if(d&&d.success)m.value="Success!",U.value=d.message||"Credit Added to account",b.value=!0;else throw new Error(d.message||"Failed to process Credit request")}catch(d){h.value="Something Went Wrong!",n.value=((A=(l=d.response)==null?void 0:l.data)==null?void 0:A.message)||d.message,T.value=!0}finally{R.value=!1}}};ee(i,()=>{le.value=structuredClone(W(i.selectedTransaction)),j.value=i.selectedTransaction.amount,V.value=i.selectedTransaction.amount});const ie=async _=>{var l,A;if(_){$.value=!0;try{const d=await Z("/processCreditIn",{method:"POST",body:{adjustment_id:i.selectedTransaction.transaction_id,amount:V.value,type:Y.value,client_id:i.selectedTransaction.client_id,mt5id:i.selectedTransaction.mt_id,action:0},onResponseError({response:E}){h.value="Something Went Wrong!",n.value=E._data.message,T.value=!0}});if(d&&d.success)m.value="Rejected!",U.value=d.message||"Credit Add Request Rejected Successfully!",b.value=!0;else throw new Error(d.message||"Failed to reject credit request")}catch(d){h.value="Something Went Wrong!",n.value=((A=(l=d.response)==null?void 0:l.data)==null?void 0:A.message)||d.message,T.value=!0}finally{$.value=!1}}},de=()=>{window.location.reload()};return(_,l)=>{const A=se,d=ae,E=pe,H=fe;return v(),K(te,null,[e(F,{width:_.$vuetify.display.smAndDown?"auto":800,"model-value":i.isDialogVisible,"onUpdate:modelValue":C},{default:t(()=>[e(A,{onClick:l[0]||(l[0]=r=>C(!1))}),e(M,null,{default:t(()=>[e(ve,null,{default:t(()=>[o("Approve / Reject Credit In Ticket")]),_:1}),e(S),e(ge,{class:"text-no-wrap"},{default:t(()=>[Ce,a("tbody",null,[a("tr",null,[a("td",null,[e(d,{client_id:i.selectedTransaction.client_id,is_wallet:i.selectedTransaction.is_wallet,mt_id:i.selectedTransaction.mt_id},null,8,["client_id","is_wallet","mt_id"])]),a("td",null,u(i.selectedTransaction.transaction_type),1)])])]),_:1}),e(S),e(Te,{onSubmit:ce(()=>{},["prevent"])},{default:t(()=>[e(B,null,{default:t(()=>[e(X,null,{default:t(()=>[e(q,{cols:"6"},{default:t(()=>[e(E,{modelValue:j.value,"onUpdate:modelValue":l[1]||(l[1]=r=>j.value=r),label:"Requested Amount",suffix:"USD",disabled:""},null,8,["modelValue"])]),_:1}),e(q,{cols:"6"},{default:t(()=>[e(E,{modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=r=>V.value=r),label:"Approved Amount",suffix:"USD"},null,8,["modelValue"]),p(ne)?(v(),k(be,{key:0,type:"error",class:"mt-2"},{default:t(()=>[o(" Approved amount cannot be greater than requested amount. ")]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1}),e(B,{class:"d-flex justify-end gap-3"},{default:t(()=>[("hasAccess"in _?_.hasAccess:p(G))("process_credit_in")?(v(),k(y,{key:0,color:"primary",class:"me-2",loading:R.value,disabled:R.value,onClick:l[3]||(l[3]=r=>s.value=!0)},{default:t(()=>[o(" Approve "),e(g,{end:"",icon:"tabler-discount-check-filled"})]),_:1},8,["loading","disabled"])):D("",!0),("hasAccess"in _?_.hasAccess:p(G))("process_credit_in")?(v(),k(y,{key:1,color:"error",class:"me-2",loading:$.value,disabled:$.value,onClick:l[4]||(l[4]=r=>I.value=!0)},{default:t(()=>[o(" Reject "),e(g,{end:"",icon:"tabler-circle-x"})]),_:1},8,["loading","disabled"])):D("",!0),e(y,{color:"secondary",onClick:l[5]||(l[5]=r=>C(!1))},{default:t(()=>[e(g,{start:"",icon:"tabler-circle-minus"}),o(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(H,{isDialogVisible:s.value,"onUpdate:isDialogVisible":l[6]||(l[6]=r=>s.value=r),onConfirm:oe,"confirmation-question":"Do you want to Approve this Credit?","cancel-title":"Cancelled","confirm-title":"Confirmed!"},null,8,["isDialogVisible"]),e(H,{isDialogVisible:I.value,"onUpdate:isDialogVisible":l[7]||(l[7]=r=>I.value=r),onConfirm:ie,"confirmation-question":"Are you sure to Reject this Credit?","cancel-title":"Cancelled","confirm-title":"Rejected!"},null,8,["isDialogVisible"]),e(F,{modelValue:b.value,"onUpdate:modelValue":l[8]||(l[8]=r=>b.value=r),"max-width":"500"},{default:t(()=>[e(M,null,{default:t(()=>[e(B,{class:"text-center px-10 py-6"},{default:t(()=>[e(y,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:t(()=>[e(g,{icon:"tabler-check",size:"38"})]),_:1}),a("h1",xe,u(m.value),1),a("p",null,u(U.value),1),e(y,{color:"success",onClick:de},{default:t(()=>[o(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(F,{modelValue:T.value,"onUpdate:modelValue":l[10]||(l[10]=r=>T.value=r),"max-width":"500"},{default:t(()=>[e(M,null,{default:t(()=>[e(B,{class:"text-center px-10 py-6"},{default:t(()=>[e(y,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:t(()=>[we]),_:1}),a("h1",De,u(h.value),1),a("p",null,u(n.value),1),e(y,{color:"success",onClick:l[9]||(l[9]=r=>T.value=!1)},{default:t(()=>[o(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},ke={class:"d-flex flex-wrap justify-space-between flex-column rounded bg-var-theme-background flex-sm-row gap-6 pa-6 mb-6"},Re=a("div",{class:"d-flex align-center app-logo mb-6"},[a("h6",{class:"app-logo-title"}," Adjustment Ticket Details ")],-1),$e={class:"d-flex flex-column"},je={class:"d-flex align-center"},Ee={class:"text-body-1"},Se={class:"d-flex align-center gap-x-2"},Ie={class:"text-body-1"},Ue={class:"d-flex align-center gap-x-2"},qe={class:"text-body-1"},ze={class:"d-flex align-center gap-x-2"},Ne={class:"text-body-1"},Be=a("h6",{class:"font-weight-medium me-4 text-overline mb-4"}," Transffered To: ",-1),Oe=a("h6",{class:"font-weight-medium me-4 text-overline mb-4"}," Details: ",-1),Me={class:"d-flex align-center"},Fe={class:"text-body-1"},We={class:"d-flex align-center"},Le={class:"text-body-1"},Pe={class:"d-flex align-center"},Ke={class:"text-body-1"},Ge={class:"d-flex align-center"},Xe={class:"text-body-1"},Ye={key:0,class:"d-flex justify-space-between flex-wrap flex-column flex-sm-row"},He=a("div",{class:"mb-6 mb-sm-0"},null,-1),Je={class:"w-100"},Qe=a("td",{class:"font-weight-medium me-4 text-overline"}," Deal Id : ",-1),Ze={class:"font-weight-medium me-4 text-overline"},et=a("td",{class:"font-weight-medium me-4 text-overline"}," Approved at : ",-1),tt={class:"font-weight-medium me-4 text-overline"},at=a("td",{class:"font-weight-medium me-4 text-overline"}," Approved By : ",-1),st={class:"font-weight-medium me-4 text-overline"},lt={class:"w-100"},nt=a("td",{class:"font-weight-medium me-4 text-overline"}," Approved Amount : ",-1),Rt={__name:"CLIENT_TransAdjustTicketDialog",props:{selectedTransaction:{type:Object,required:!1},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","update:isDialogVisible"],setup(L,{emit:P}){const s=L,I=P,T=c(structuredClone(W(s.selectedTransaction))),b=c(!1);ee(s,()=>{T.value=structuredClone(W(s.selectedTransaction))});const h=n=>{I("update:isDialogVisible",n)};return(n,m)=>{var z;const U=se,R=Ve,$=ye,j=he,V=ae,i=Ae;return v(),K(te,null,[e(F,{width:n.$vuetify.display.smAndDown?"auto":800,"model-value":s.isDialogVisible,"onUpdate:modelValue":h},{default:t(()=>[e(U,{onClick:m[0]||(m[0]=C=>h(!1))}),e(M,{class:"pa-6 pa-sm-10"},{default:t(()=>[a("div",ke,[a("div",null,[Re,e(f,{class:"p-0 m-0"},{default:t(()=>[e(R,{client_id:s.selectedTransaction.client_id,client_name:s.selectedTransaction.client_name,email:s.selectedTransaction.email},null,8,["client_id","client_name","email"])]),_:1}),s.selectedTransaction.manager_id!=null?(v(),k(f,{key:0,class:"p-0 m-0"},{default:t(()=>[e($,{rm_id:s.selectedTransaction.manager_id,rm_name:s.selectedTransaction.rm_name,rm_email:"Relationship Manager"},null,8,["rm_id","rm_name"])]),_:1})):D("",!0)]),a("div",$e,[e(f,null,{prepend:t(()=>[e(O,{size:"38",color:"secondary",variant:"tonal",class:"me-1",rounded:""},{default:t(()=>[e(g,{icon:"tabler-droplet-dollar",size:"22"})]),_:1})]),append:t(()=>[a("div",je,[a("div",Ee,[e(w,{variant:"outlined"},{default:t(()=>[o(" #"+u(s.selectedTransaction.transaction_id),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" TICKET ID ")]),_:1})]),_:1}),e(f,null,{prepend:t(()=>[e(O,{size:"38",color:"secondary",variant:"tonal",class:"me-1",rounded:""},{default:t(()=>[e(g,{icon:"tabler-droplet-dollar",size:"22"})]),_:1})]),append:t(()=>[a("div",Se,[a("div",Ie,[e(w,{variant:"outlined"},{default:t(()=>[o(u(("formatDate"in n?n.formatDate:p(re))(s.selectedTransaction.created_at)),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" CREATED ON ")]),_:1})]),_:1}),e(f,null,{prepend:t(()=>[e(O,{size:"38",color:"secondary",variant:"tonal",class:"me-1",rounded:""},{default:t(()=>[e(g,{icon:"tabler-droplet-dollar",size:"22"})]),_:1})]),append:t(()=>[a("div",Ue,[a("div",qe,[e(w,{variant:"outlined"},{default:t(()=>[o(u(("formatTime"in n?n.formatTime:p(ue))(s.selectedTransaction.created_at)),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" CREATED TIME ")]),_:1})]),_:1}),e(f,null,{prepend:t(()=>[e(O,{size:"38",color:"secondary",variant:"tonal",class:"me-1",rounded:""},{default:t(()=>[e(g,{icon:"tabler-droplet-dollar",size:"22"})]),_:1})]),append:t(()=>[a("div",ze,[a("div",Ne,[e(j,{trans_status:s.selectedTransaction.status},null,8,["trans_status"])])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" TRANSACTION STATUS ")]),_:1})]),_:1})])]),e(X,null,{default:t(()=>[e(q,{class:"text-no-wrap"},{default:t(()=>[Be,e(V,{client_id:s.selectedTransaction.client_id,is_wallet:s.selectedTransaction.is_wallet,mt_id:s.selectedTransaction.mt_id},null,8,["client_id","is_wallet","mt_id"])]),_:1}),e(q,{class:"text-no-wrap"},{default:t(()=>[Oe,e(f,{class:"my-0 py-0"},{append:t(()=>[a("div",Me,[a("div",Fe,[e(w,{variant:"outlined"},{default:t(()=>[o(u(s.selectedTransaction.mt_group_name),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" MT GROUP ")]),_:1})]),_:1}),e(f,{class:"my-0 py-0"},{append:t(()=>[a("div",We,[a("div",Le,[e(w,{variant:"outlined"},{default:t(()=>[o(u(s.selectedTransaction.transaction_type),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" Transaction Type ")]),_:1})]),_:1}),e(f,{class:"my-0 py-0"},{append:t(()=>[a("div",Pe,[a("div",Ke,[e(w,{variant:"outlined"},{default:t(()=>[o(u(("formatCurrency"in n?n.formatCurrency:p(Q))(s.selectedTransaction.amount)),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" Requested Amount IN USD ")]),_:1})]),_:1}),e(f,{class:"my-0 py-0"},{append:t(()=>[a("div",Ge,[a("div",Xe,[e(w,{variant:"outlined"},{default:t(()=>[o(u(s.selectedTransaction.client_note),1)]),_:1})])])]),default:t(()=>[e(x,{class:"font-weight-medium me-4 text-overline"},{default:t(()=>[o(" CLIENT NOTE ")]),_:1})]),_:1})]),_:1})]),_:1}),e(S,{class:"mt-6 border-dashed"}),e(S,{class:"mt-1 mb-6 border-dashed"}),s.selectedTransaction.status===3?(v(),K("div",Ye,[He,a("div",null,[a("table",Je,[a("tbody",null,[a("tr",null,[Qe,a("td",{class:N(n.$vuetify.locale.isRtl?"text-start":"text-end")},[a("h6",Ze," #"+u(s.selectedTransaction.dealid),1)],2)]),a("tr",null,[et,a("td",{class:N(n.$vuetify.locale.isRtl?"text-start":"text-end")},[a("h6",tt,u(("formatFullDateTime"in n?n.formatFullDateTime:p(me))(s.selectedTransaction.updated_at)),1)],2)]),a("tr",null,[at,a("td",{class:N(n.$vuetify.locale.isRtl?"text-start":"text-end")},[a("h6",st,u(s.selectedTransaction.approved_by_rm_name?s.selectedTransaction.approved_by_rm_name:"AUTO"),1)],2)])])]),e(S,{class:"mt-4 mb-3"}),a("table",lt,[a("tbody",null,[a("tr",null,[nt,a("td",{class:N(n.$vuetify.locale.isRtl?"text-start":"text-end")},[e(w,{size:"default",color:"secondary",variant:"tonal",class:"text-h5"},{default:t(()=>[o(u(("formatCurrency"in n?n.formatCurrency:p(Q))(s.selectedTransaction.amount)),1)]),_:1})],2)])])])])])):D("",!0),s.selectedTransaction.status===0?(v(),k(X,{key:1},{default:t(()=>[e(q,{class:"col-10 text-sm-end"},{default:t(()=>[("hasAccess"in n?n.hasAccess:p(G))("process_credit_in")?(v(),k(y,{key:0,class:"me-2",color:"primary",onClick:m[1]||(m[1]=C=>b.value=!0)},{default:t(()=>[o(" Approve/Reject Credit In "),e(g,{end:"",icon:"tabler-checkbox"})]),_:1})):D("",!0),e(y,{color:"secondary",onClick:m[2]||(m[2]=C=>h(!1))},{default:t(()=>[e(g,{start:"",icon:"tabler-circle-minus"}),o(" Cancel ")]),_:1})]),_:1})]),_:1})):D("",!0),e(S,{class:"my-6 border-dashed"})]),_:1})]),_:1},8,["width","model-value"]),s.selectedTransaction?(v(),k(i,{key:0,isDialogVisible:p(b),"onUpdate:isDialogVisible":m[3]||(m[3]=C=>_e(b)?b.value=C:null),selectedTransaction:s.selectedTransaction,transaction_id:(z=s.selectedTransaction)==null?void 0:z.transaction_id},null,8,["isDialogVisible","selectedTransaction","transaction_id"])):D("",!0)],64)}}};export{Rt as _};
