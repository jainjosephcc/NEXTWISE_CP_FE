import{_ as P}from"./ConfirmDialog-CHCp6S9v.js";import{_ as U}from"./CustomClientCardChip-B9radVMG.js";import{$ as g}from"./api-iWVA-fzn.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as z,a as A}from"./VRow-BrVMZuB9.js";import{V as f}from"./VCard-DwrpuyUm.js";import{V as N}from"./VDialog-BiIRwhKC.js";import{V as k}from"./VCardText-Cz0O4UdD.js";import{V as K}from"./VCardTitle-vKV3lDGn.js";import{r as n,E as q,o as V,c as w,d as e,b as t,e as a,F as S,t as m,ah as p,$ as x,f as H,y as X,h as J,v as r,bb as Q,b9 as Y,ba as Z}from"./index-B7DVBXb6.js";import{V as ee}from"./VTable-THd5MxoR.js";import{V as te}from"./VAvatar-Ra1G3_lq.js";import{V as le}from"./VImg-BjgCukri.js";import{V as ae}from"./VChip-B1ab4KKX.js";import"./permission-BvJbWOm-.js";import"./VList-D72edMu7.js";import"./index-Dh-m6d15.js";import"./ssrBoot-DrrL7aUO.js";import"./transition-Dd-W0Z6m.js";import"./createSimpleFunctional-DmsxsSBz.js";import"./VDivider-CxEbendv.js";import"./index-B3bPRkoL.js";/* empty css              */import"./VOverlay-CtWk2Duf.js";import"./easing-CjukEv2V.js";import"./lazy-Y9WA560v.js";import"./scopeId-DcXJYuoN.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Lv4mEjsG.js";import"./VSlideGroup-Wswso1AF.js";const L=_=>(Y("data-v-44704062"),_=_(),Z(),_),se={class:"d-flex mb-6"},oe={class:"d-flex align-center justify-space-between"},ne=L(()=>e("thead",null,[e("tr",null,[e("th",null,"MT5ID"),e("th",null,"ID"),e("th",null,"CLIENET NAME"),e("th",null,"LOSABLE"),e("th",null,"NON LOSABLE"),e("th",null,"BALANCE"),e("th",null,"CREDIT"),e("th",null,"LAST FETCHED"),e("th",null,"ACTION")])],-1)),re={style:{"block-size":"100px","inline-size":"60px"},class:"d-flex flex-column justify-center align-center cursor-pointer rounded py-4 px-5 me-4"},ie={class:"text-h4 mb-4"},ue=L(()=>e("span",{class:"text-5xl font-weight-light"},"X",-1)),de={class:"text-h4 mb-4"},ce={__name:"credit-manager",setup(_){const c=n([]),B=n(null),b=n(!1),y=n(null),I=n(null),C=n(""),D=n(""),T=n(""),E=n(""),v=n(!1),h=n(!1),u=n(!1),$=async()=>{try{u.value=!0;const s=await g("meta-credit-manager/list",{method:"GET"});s&&(c.value=s.data)}catch(s){console.error("Error fetching credit data:",s),B.value=s}finally{u.value=!1}},O=async s=>{try{u.value=!0;const o=await g(`meta-credit-manager/mt-info/${s}`,{method:"GET"});if(o){const i=o.data,d=c.value.findIndex(l=>l.mt5_id===s);d!==-1&&(c.value[d]={...c.value[d],...i})}}catch(o){console.error(`Error fetching data for MT5 ID: ${s}`,o)}finally{u.value=!1}},R=async()=>{var s,o;try{u.value=!0,await g("meta-credit-manager/mt-info/update-all",{method:"GET"})&&(C.value="Data Refreshed!",D.value="All MT5 credit data has been refreshed successfully!",v.value=!0)}catch(i){console.error("Error refreshing all MT5 data:",i),T.value="Something Went Wrong!",E.value=((o=(s=i.response)==null?void 0:s._data)==null?void 0:o.message)||"Error occurred",h.value=!0}finally{u.value=!1}},F=s=>{y.value=s.id,I.value=s.mt5_id,b.value=!0},W=async s=>{var o,i;if(s)try{await g("meta-credit-manager/delete",{method:"POST",body:{id:y.value,mt5_id:I.value}})&&(c.value=c.value.filter(l=>l.id!==y.value),C.value="Deleted!",D.value="Credit entry deleted successfully!",v.value=!0)}catch(d){T.value="Something Went Wrong!",E.value=((i=(o=d.response)==null?void 0:o._data)==null?void 0:i.message)||"Error occurred",h.value=!0}},M=()=>{window.location.reload()};return q(()=>{$()}),(s,o)=>{const i=U,d=P;return V(),w(S,null,[e("section",null,[e("div",se,[t(z,null,{default:a(()=>[t(A,{cols:"12"},{default:a(()=>[t(f,null,{default:a(()=>[t(k,null,{default:a(()=>[e("div",oe,[t(K,null,{default:a(()=>[m(" Credit Manager ")]),_:1}),e("div",null,[t(p,{class:"me-2",onClick:R,disabled:u.value},{default:a(()=>[t(x,{icon:"tabler-refresh"}),m("Refresh Data "),u.value?(V(),H(Q,{key:0,indeterminate:"",size:"24",class:"ms-2"})):X("",!0)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1})]),_:1})]),t(f,{class:"mb-6"},{default:a(()=>[t(z,null,{default:a(()=>[t(A,{cols:"12"},{default:a(()=>[t(f,null,{default:a(()=>[t(ee,{height:"800","fixed-header":"",class:"text-no-wrap"},{default:a(()=>[ne,e("tbody",null,[(V(!0),w(S,null,J(c.value,l=>(V(),w("tr",{key:l.id},[e("td",null,[e("div",re,[t(te,{rounded:"",size:"45",variant:"tonal",class:"mb-2 ps-1 pe-1"},{default:a(()=>[t(le,{src:"/images/svg/mt5_lined.svg",size:"22"})]),_:1}),m(" "+r(l.mt5_id),1)])]),e("td",null,[t(ae,{size:"x-small"},{default:a(()=>[m(r(l.id),1)]),_:2},1024)]),e("td",null,[t(i,{client_name:l.client_name,client_id:l.client_id,email:l.email},null,8,["client_name","client_id","email"])]),e("td",null,r(l.losable),1),e("td",null,r(l.non_losable),1),e("td",null,r(l.balance),1),e("td",null,r(l.credit),1),e("td",null,r(l.last_fetched_at?l.last_fetched_at:"Never Fetched"),1),e("td",null,[t(x,{icon:"tabler-refresh",class:"me-2",onClick:G=>O(l.mt5_id)},null,8,["onClick"]),t(x,{icon:"tabler-trash",onClick:G=>F(l)},null,8,["onClick"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),t(d,{isDialogVisible:b.value,"onUpdate:isDialogVisible":o[0]||(o[0]=l=>b.value=l),onConfirm:W,"confirmation-question":"Are you sure you want to delete this credit?","cancel-title":"Cancel","confirm-title":"Delete!"},null,8,["isDialogVisible"]),t(N,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=l=>v.value=l),"max-width":"500"},{default:a(()=>[t(f,null,{default:a(()=>[t(k,{class:"text-center px-10 py-6"},{default:a(()=>[t(p,{icon:"",variant:"outlined",color:"success",class:"my-4",style:{"block-size":"88px","inline-size":"88px"}},{default:a(()=>[t(x,{icon:"tabler-check",size:"38"})]),_:1}),e("h1",ie,r(C.value),1),e("p",null,r(D.value),1),t(p,{color:"success",onClick:M},{default:a(()=>[m("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{modelValue:h.value,"onUpdate:modelValue":o[2]||(o[2]=l=>h.value=l),"max-width":"500"},{default:a(()=>[t(f,null,{default:a(()=>[t(k,{class:"text-center px-10 py-6"},{default:a(()=>[t(p,{icon:"",variant:"outlined",color:"error",class:"my-4",style:{"block-size":"88px","inline-size":"88px"}},{default:a(()=>[ue]),_:1}),e("h1",de,r(T.value),1),e("p",null,r(E.value),1),t(p,{color:"success",onClick:M},{default:a(()=>[m("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Ge=j(ce,[["__scopeId","data-v-44704062"]]);export{Ge as default};
